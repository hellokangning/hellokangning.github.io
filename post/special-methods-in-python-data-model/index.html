<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Special Methods in Python Data Model - Guoqing Geng</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Guoqing Geng" />
  <meta name="description" content="You can think of the Data Model as a description of Python as a framework. It formalizes the interfaces of the building blocks of the languages itself, such as sequences, iterators, functions, classes, context managers and so on.
Python allows operator overloading, which let us to define the custom behavior for a class. For instance, if a class defines a __str__(), then it can return a readable string representation of an object.
In this post, I will enumerate some special methods that can change the behavior of an object and may putted into practice in daily work.

" />

  <meta name="keywords" content="elasticsearch, python, hbase" />






<meta name="generator" content="Hugo 0.44" />


<link rel="canonical" href="https://hellokangning.github.io/post/special-methods-in-python-data-model/" />

<link rel="apple-touch-icon" sizes="180x180" href="https://hellokangning.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hellokangning.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://hellokangning.github.io/favicon-16x16.png">
<link rel="manifest" href="https://hellokangning.github.io/manifest.json">
<link rel="mask-icon" href="https://hellokangning.github.io/safari-pinned-tab.svg" color="#5bbad5">







<link href="https://hellokangning.github.io/dist/even.min.css?v=3.2.0" rel="stylesheet">
<link href="https://hellokangning.github.io/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">




<meta property="og:title" content="Special Methods in Python Data Model" />
<meta property="og:description" content="You can think of the Data Model as a description of Python as a framework. It formalizes the interfaces of the building blocks of the languages itself, such as sequences, iterators, functions, classes, context managers and so on.

Python allows operator overloading, which let us to define the custom behavior for a class. For instance, if a class defines a __str__(), then it can return a readable string representation of an object.

In this post, I will enumerate some special methods that can change the behavior of an object and may putted into practice in daily work.

" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hellokangning.github.io/post/special-methods-in-python-data-model/" />



<meta property="article:published_time" content="2018-10-16T15:19:05&#43;08:00"/>

<meta property="article:modified_time" content="2018-10-17T19:19:05&#43;08:00"/>











<meta itemprop="name" content="Special Methods in Python Data Model">
<meta itemprop="description" content="You can think of the Data Model as a description of Python as a framework. It formalizes the interfaces of the building blocks of the languages itself, such as sequences, iterators, functions, classes, context managers and so on.

Python allows operator overloading, which let us to define the custom behavior for a class. For instance, if a class defines a __str__(), then it can return a readable string representation of an object.

In this post, I will enumerate some special methods that can change the behavior of an object and may putted into practice in daily work.

">


<meta itemprop="datePublished" content="2018-10-16T15:19:05&#43;08:00" />
<meta itemprop="dateModified" content="2018-10-16T15:19:05&#43;08:00" />
<meta itemprop="wordCount" content="721">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Special Methods in Python Data Model"/>
<meta name="twitter:description" content="You can think of the Data Model as a description of Python as a framework. It formalizes the interfaces of the building blocks of the languages itself, such as sequences, iterators, functions, classes, context managers and so on.

Python allows operator overloading, which let us to define the custom behavior for a class. For instance, if a class defines a __str__(), then it can return a readable string representation of an object.

In this post, I will enumerate some special methods that can change the behavior of an object and may putted into practice in daily work.

"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="https://hellokangning.github.io/" class="logo">Guoqing Geng</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://hellokangning.github.io/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="https://hellokangning.github.io/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="https://hellokangning.github.io/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="https://hellokangning.github.io/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="https://hellokangning.github.io/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="https://hellokangning.github.io/" class="logo">Guoqing Geng</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://hellokangning.github.io/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://hellokangning.github.io/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://hellokangning.github.io/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://hellokangning.github.io/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://hellokangning.github.io/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Special Methods in Python Data Model</h1>

      <div class="post-meta">
        <span class="post-time"> Oct 16, 2018 </span>
        <div class="post-category">
            
              <a href="https://hellokangning.github.io/categories/python/"> Python </a>
            
          </div>
        <span class="more-meta"> 721 words </span>
        <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li><a href="#str"><code>__str__</code></a></li>
<li><a href="#repr"><code>__repr__</code></a></li>
<li><a href="#hash"><code>__hash__</code></a></li>
<li><a href="#bool"><code>__bool__</code></a></li>
<li><a href="#len"><code>__len__</code></a></li>
<li><a href="#getitem"><code>__getitem__</code></a></li>
<li><a href="#missing"><code>__missing__</code></a></li>
<li><a href="#iadd"><code>__iadd__</code></a></li>
<li><a href="#abs"><code>__abs__</code></a></li>
<li><a href="#iter"><code>__iter__</code></a></li>
</ul>
</nav>
  </div>
</div>

    
    

    
    <div class="post-content">
      <p>You can think of the Data Model as a description of Python as a framework. It formalizes the interfaces of the building blocks of the languages itself, such as sequences, iterators, functions, classes, context managers and so on.</p>

<p>Python allows operator overloading, which let us to define the custom behavior for a class. For instance, if a class defines a <code>__str__()</code>, then it can return a readable string representation of an object.</p>

<p>In this post, I will enumerate some special methods that can change the behavior of an object and may putted into practice in daily work.</p>

<p></p>

<p>The special names are always spelled with leading and trailing double underscore, i.e. <code>__str__</code>.</p>

<h1 id="str"><code>__str__</code></h1>

<p><code>__str()__</code> is called by <code>str(object)</code> and built-in functions such as <code>format()</code> and <code>print()</code> for a nicely printable string of an object. the return value must be a <code>string</code> object.</p>

<p>The default implementation defined by the built-in type object calls <code>__repr()__</code>.</p>

<pre><code class="language-python">class Element:
    def __init__(self, k, v):
        self.key = k
        self.value = v

    def __str__(self):
        return '%s -&gt; %s' % (self.key ,self.value)

c = Element('a', 'b')
print(c) # print a -&gt; b
</code></pre>

<h1 id="repr"><code>__repr__</code></h1>

<p><code>__repr__()</code> is called by <code>repr()</code> function to compute the string representation of an object.</p>

<p>The difference between <code>__str__()</code> and <code>__repr__()</code> is</p>

<ul>
<li><code>__repr__()</code> is for developers, and should be unambiguous.</li>
<li><code>__str__()</code> is for customers, and should be readable.</li>
</ul>

<h1 id="hash"><code>__hash__</code></h1>

<p><code>__hash()</code> is called by built-in <code>hash()</code> for operations on members of hashed collections including <code>set</code>, <code>frozenset</code> and <code>dict</code>. <code>__hash__()</code> return an integer, and the objects that are equal should have the same hash value.</p>

<p>A class that overrides <code>__eq__()</code> and does not define <code>__hash__()</code> will have its <code>__hash__()</code> implicitly set to None.</p>

<h1 id="bool"><code>__bool__</code></h1>

<p><code>__bool__()</code> by the built-in <code>bool()</code> is called to implement truth value testing. When this method is not defined, <code>__len__()</code> is called.</p>

<pre><code class="language-python">class Element:
    def __init__(self, k, v):
        self.key = k
        self.value = v

    def __bool__(self):
        return self.key != 0

a = Element(0, 'a')
if a: # False
    print('a') 

b = Element(1, 'b')
if b: # True
    print('b')
</code></pre>

<h1 id="len"><code>__len__</code></h1>

<p><code>__len__()</code> is called to implemented the build-in function <code>len()</code>. It should return the length of the object.</p>

<blockquote>
<p>For built-in types like <code>list</code>, <code>str</code>, <code>bytearray</code> etc., the interpreter takes a shortcut: the CPython implementation of <code>len()</code> actually returns the value of the <code>ob_size</code> field in the <code>PyVarObject</code> struct that represents any variable-sized built-in object in memory.</p>
</blockquote>

<h1 id="getitem"><code>__getitem__</code></h1>

<p><code>__getitem__(self, key)</code> is called to implement evaluation of <code>self[key]</code>. For sequence types, the accepted keys should be integers and slice objects.</p>

<pre><code class="language-python">from collections import namedtuple

Card = namedtuple('Card', ['rank','suit'])

class Deck:
    ranks = [str(i) for i in range(2,11)] + list('JQKA')
    suits = 'spades diamonds clubs hearts'.split()

    def __init__(self):
        self._cards = [Card(r, s) for s in self.suits for r in self.ranks]

    def __len__(self):
        return len(self._cards)

    def __getitem__(self, position):
        return self._cards[position]

d = Deck()
print(len(d)) # print 52
</code></pre>

<p>By implementing the special methods <code>__len__</code> and <code>__getitem__</code>, our <code>Deck</code> behaves like a standard Python sequence, allowing it to benefit from the core language features - like iteration and slicing.</p>

<pre><code class="language-python">d = Deck()

# [Card(rank='2', suit='spades'), Card(rank='3', suit='spades'), Card(rank='4', suit='spades')]
print(d[:3]) 

for card in reversed(d):
    print(card)
</code></pre>

<h1 id="missing"><code>__missing__</code></h1>

<p><code>__missing__(self, key)</code> is called by <code>dict.__getitem__()</code> when key is not present.</p>

<h1 id="iadd"><code>__iadd__</code></h1>

<p><code>__iadd__(self, other)</code> implements addition with assignment. For instance, for <code>a += b</code>, <code>__iadd__</code> might return <code>a + b</code>, which would be assigned to <code>a</code>.</p>

<pre><code class="language-python">class Element:
    def __init__(self, k, v):
        self.key = k
        self.value = v

    def __iadd__(self, other):
        self.key += other.key
        self.value += other.value
        return self

    def __str__(self):
        return '%d -&gt; %s' % (self.key, self.value)

a = Element(1, 'a')
a += Element(2, 'b')
print(a) # 3 -&gt; ab
</code></pre>

<h1 id="abs"><code>__abs__</code></h1>

<p>The <code>abs</code> built-in function returns the absolute value of integers and floats, and the magnitude of <code>complex</code> number. Actually, it is <code>__abs__</code> that takes effect underneath.</p>

<pre><code class="language-python">from math import hypot
class Vector:
    def __init__(self, x=0,y=0):
        self.x = x
        self.y = y
    def __abs__(self):
        return hypot(self.x, self.y)

v = Vector(3, 4)
print(abs(v)) # 5.0
</code></pre>

<h1 id="iter"><code>__iter__</code></h1>

<p>This method is called when an iterator is required for a container. This method should return a new iterator object that can iterate over all the objects in the container.</p>

<pre><code class="language-python">class Vector:
    def __init__(self, x, y):
        self.x = x
        self.y = y

    def __iter__(self):
        return (i for i in (self.x, self.y))

v = Vector(2, 3)
x, y = v
print(x, y) # 2 3
</code></pre>

<p><strong>Reference</strong></p>

<ul>
<li><a href="https://docs.python.org/3.8/reference/datamodel.html">Data Model</a></li>
<li><a href="https://rszalski.github.io/magicmethods/">A Guide to Python&rsquo;s Magic Methods</a></li>
</ul>
    </div>

    
    

    
    

    <footer class="post-footer">
      

      
      <nav class="post-nav">
        
          <a class="prev" href="https://hellokangning.github.io/post/using-mixins-with-python/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Using Mixins with Python</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="https://hellokangning.github.io/post/a-few-things-about-spark/">
            <span class="next-text nav-default">A Few Things That I Know About Spark</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'guoqing';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:hellokangning@hotmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://www.linkedin.com/in/guoqing-geng-9032b820/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://github.com/hellokangning" class="iconfont icon-github" title="github"></a>
  <a href="https://hellokangning.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    
      2016 - 
    2018
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Guoqing Geng</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="https://hellokangning.github.io/lib/highlight/highlight.pack.js?v=20171001"></script><script type="text/javascript" src="https://hellokangning.github.io/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="https://hellokangning.github.io/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="https://hellokangning.github.io/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>


<script type="text/javascript" src="https://hellokangning.github.io/dist/even.min.js?v=3.2.0"></script>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-105833321-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
